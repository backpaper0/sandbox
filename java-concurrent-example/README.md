# Java並行処理による性能向上のデモ

## 概要

このプロジェクトは、Javaのプラットフォームスレッドと仮想スレッド（Virtual Threads）を使用した並行処理の性能比較を行うデモアプリケーションです。CPUバウンドな処理を例に、異なる並行処理方式による実行時間の違いを確認できます。

このデモでは、以下の実行方式を比較できます：

- **シングルスレッド実行**: 並行処理を行わない基準となる実装
- **プラットフォームスレッド実行**: 従来のOSネイティブスレッドを使用した並列処理
- **仮想スレッド実行**: Java 21の仮想スレッドを使用した並列処理

## 準備

プロジェクトをビルドするために、以下のコマンドを実行してください。

```bash
mvn compile
```

## 実行方法

### CPUバウンドな処理の性能比較

#### 1. シングルスレッド実行

並行処理を行わず、すべての処理を順次実行します。他の実行方式との性能比較の基準となります。

```bash
mvn exec:exec -Dexecutor=single
```

#### 2. プラットフォームスレッド実行

従来のJavaスレッド（プラットフォームスレッド）を使用して並列処理を行います。デフォルトでは8スレッドで実行されます。

```bash
mvn exec:exec -Dexecutor=platform
```

#### 3. 仮想スレッド実行（推奨設定）

Java 21の仮想スレッドを使用して並列処理を行います。デフォルトでは8個のプラットフォームスレッドが割り当てられ、効率的に並列処理が実行されます。

```bash
mvn exec:exec -Dexecutor=virtual
```

#### 4. 仮想スレッド実行（制限あり）

仮想スレッドに割り当てられるプラットフォームスレッド数を1に制限します。この設定では並列実行の効果が得られず、性能向上は期待できません。仮想スレッドの制約を理解するための参考実装です。

```bash
mvn exec:exec -Dexecutor=virtual -Dparallelism=1
```

## 期待される結果

CPUバウンドな処理の場合、以下のような性能差が観察できます：

- **シングルスレッド**: 最も処理時間がかかる
- **プラットフォームスレッド（8スレッド）**: シングルスレッドと比較して大幅に高速
- **仮想スレッド（並列度8）**: プラットフォームスレッドと同等の性能
- **仮想スレッド（並列度1）**: シングルスレッドと同等の性能
